<!DOCTYPE html>
<html>
<head>
	<title>Mapnik Bench</title>
	<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
	<style>
	body {
		font-family: sans-serif;
	}
	table {
		border-collapse: collapse;
	}
	table td,
	table th {
		border: 1px solid #c0c0c0;
		padding: 10px;
		min-width: 100px;
	}
	th {
		background: #f6f6f6;
	}
	.geom,
	.ver {
		font-family: monospace;
	}
	.ver {}
	.high {
		background: #2ECC40;
	}
	.low {
		background: #FF4136;
	}
	</style>
</head>
<body>
<div id="data"></div>

<script>
var geometries = [];
var versions = [];
var bench;
// yay DOM strings :(

$(document).ready(function(){
	$.getJSON( "data.json", function( data ) {
		console.log(data);
		bench = data;

		// for each version
		for (var v in data.versions) {
			var VERSION = data.versions[v];

			// gather versions if we haven't pushed yet
			if (versions.indexOf(v) == -1) versions.push(v);

			// for each test in the version
			for (var g in VERSION) {
				var GEOM = VERSION[g];

				// gather geometries if they haven't been added yet
				if (geometries.indexOf(g) == -1) geometries.push(g); 


			}
		}

		makeTheTable(geometries, versions);
	});
});

function makeTheTable(g, v) {

	// create headers
	var header = '<tr><th>geom</th>';
	var table = '<table>';
	$.each(versions, function(v) {
		header+='<th class="ver">'+versions[v]+'</th>';
	});
	header += '</tr>';
	var rows = '';

	// go through each geometry and get the version information for that geom
	$.each(geometries, function(g) {
		var row = '<tr><td class="geom">'+geometries[g]+'</td>';
		$.each(versions, function(v) {
			var B = bench.versions[versions[v]][geometries[g]].result;
			var time = Math.round(B.time * 100) / 100;
			var tps = Math.round(B.tiles_per_second * 100) / 100;
			var tpst = Math.round(B.tiles_per_second_per_thread * 100) / 100;
			row += '<td><strong>'+time+'</strong> seconds<br><small><strong>'+B.tiles_rendered+'</strong> total tiles rendered<br><strong>'+tps+'</strong> TPS<br><strong>'+tpst+'</strong> TPS per thread</small></td>';
		});
		row += '</tr>';
		rows += row;
	});

	table += header + rows + '</table>';
	document.getElementById('data').innerHTML = table;
}

function minmax(array) {

}
</script>
</body>
</html>